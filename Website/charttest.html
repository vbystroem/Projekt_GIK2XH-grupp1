<!DOCTYPE html>
<html>
<head>
  <title>Highcharts Line Diagram from CSV</title>
  <!-- Include the Highcharts library -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>
    <!-- Create a container for the chart -->
    <div id="chartContainer" style="width: 100%; height: 800px;"></div>
  
    <script>
      // Parse the .csv file (example using fetch API)
      fetch('RIAA Revenue Chart 1973-2021 Grouped v2.csv')
        .then(response => response.text())
        .then(csvData => {
          // Convert the CSV data to a usable format (example using PapaParse)
          const parsedData = Papa.parse(csvData, { header: true }).data;
  
          // Extract unique formats
          const formats = Array.from(new Set(parsedData.map(item => item.format)));
  
          // Prepare series data for each format
          const seriesData = formats.map(format => {
            const data = parsedData
              .filter(item => item.format === format)
              .map(item => [parseInt(item.year), parseFloat(item.revenue)]);
            return {
              name: format,
              data: data.sort((a, b) => a[0] - b[0]) // Sort data by year
            };
          });
  
          // Initialize the Highcharts chart
          Highcharts.chart('chartContainer', {
            chart: {
              type: 'spline' // Set the chart type to line
            },
            title: {
              text: 'Revenue by Format'
            },
            xAxis: {
              title: {
                text: 'Year'
              }
            },
            yAxis: [{
                labels: {
                    format: '${value} m',
                    style: {
                        color: Highcharts.getOptions().colors[2]
                    }
                },
                title: {
                    text: 'Revenue',
                    style: {
                        color: Highcharts.getOptions().colors[2]
                    }
                },
            series: seriesData
            },
            { // Secondary yAxis
                gridLineWidth: 0,
                title: {
                    text: 'Loudness',
                    style: {
                        color: Highcharts.getOptions().colors[0]
                    }
                },
                labels: {
                    format: '{value} dbFS',
                    style: {
                        color: Highcharts.getOptions().colors[0]
                    }
                },
                opposite: true
            }]
        });
        })
        .catch(error => {
          console.error('Error:', error);
        });
    </script>
  </body>
</html>
